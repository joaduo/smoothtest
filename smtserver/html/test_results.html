<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <script type="text/javascript" src="http://jplayer.org/latest/lib/jquery.min.js"></script>
      <script type="text/javascript">
        var websocket;
        
        function append_test_result(test_results) {
      	  $('#test_results').append('<div>'+ JSON.stringify(test_results) + '</div>');
        }
    
        function create_websocket() {
          websocket = new WebSocket("ws://localhost:8080/updates");
          // When a message arrives, append the test result
          websocket.onmessage = function(e) {
            var data = JSON.parse(e.data);
            append_test_result(data);
          };
          // Recreate websocket if closed
          websocket.onclose = function(e) {
            create_websocket();
          };
        }
        
        function send_command(cmd) {
            websocket.send(JSON.stringify(data));
        }
        
        $(document).ready( function() {
          if("WebSocket" in window) {
            append_test_result("Opening websocket...");
            create_websocket();
          }
          else {
            append_test_result("WebSocket not supported.");
          }
        })
      </script>
  </head>
  <body>
     <div id="test_results">
     
     </div>
  </body>
</html>
